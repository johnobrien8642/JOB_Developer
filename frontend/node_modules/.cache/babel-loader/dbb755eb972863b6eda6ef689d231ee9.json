{"ast":null,"code":"import _slicedToArray from\"/Users/johnobrien/Desktop/Rumblr_PROD/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{useMutation,useQuery}from'@apollo/client';import Cookies from'js-cookie';import Queries from'../../../../../graphql/queries.js';import Mutations from'../../../../../graphql/mutations.js';import UpdateCacheUtil from'../../../util/functions/update_cache_util.js';import doesUserFollow from'../../functions/does_user_follow.js';import{jsx as _jsx}from\"react/jsx-runtime\";var FOLLOW=Mutations.FOLLOW,UNFOLLOW=Mutations.UNFOLLOW;var FETCH_USER=Queries.FETCH_USER;var followUpdate=UpdateCacheUtil.followUpdate,unfollowUpdate=UpdateCacheUtil.unfollowUpdate;var FollowButton=function FollowButton(_ref){var feed=_ref.feed,user=_ref.user,tag=_ref.tag;var _useMutation=useMutation(FOLLOW,{update:function update(client,_ref2){var data=_ref2.data;var follow=data.follow;followUpdate(client,follow,FETCH_USER,Cookies.get('currentUser'),user?'User':'Tag');},onError:function onError(error){console.log(error.message);}}),_useMutation2=_slicedToArray(_useMutation,1),follow=_useMutation2[0];var _useMutation3=useMutation(UNFOLLOW,{update:function update(client,_ref3){var data=_ref3.data;var unfollow=data.unfollow;unfollowUpdate(client,unfollow,FETCH_USER,Cookies.get('currentUser'),user?'User':'Tag');},onError:function onError(error){console.log(error.message);}}),_useMutation4=_slicedToArray(_useMutation3,1),unfollow=_useMutation4[0];var _useQuery=useQuery(FETCH_USER,{variables:{query:Cookies.get('currentUser')}}),loading=_useQuery.loading,error=_useQuery.error,currentUser=_useQuery.data;if(loading)return'Loading...';if(error)return\"Error: \".concat(error);if(doesUserFollow(currentUser.user,user,tag)){return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();unfollow({variables:{user:Cookies.get('currentUser'),item:user?user._id:tag._id}});},children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Unfollow\"})})});}else{return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();follow({variables:{user:Cookies.get('currentUser'),item:user?user._id:tag._id,itemKind:user?'User':'Tag'}});},children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Follow\"})})});}};export default FollowButton;","map":{"version":3,"sources":["/Users/johnobrien/Desktop/Rumblr_PROD/client/src/components/posts/util/components/social/Follow_Button.js"],"names":["React","useMutation","useQuery","Cookies","Queries","Mutations","UpdateCacheUtil","doesUserFollow","FOLLOW","UNFOLLOW","FETCH_USER","followUpdate","unfollowUpdate","FollowButton","feed","user","tag","update","client","data","follow","get","onError","error","console","log","message","unfollow","variables","query","loading","currentUser","e","preventDefault","item","_id","itemKind"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useMutation, useQuery } from '@apollo/client';\nimport Cookies from 'js-cookie';\n\nimport Queries from '../../../../../graphql/queries.js';\nimport Mutations from '../../../../../graphql/mutations.js';\nimport UpdateCacheUtil from '../../../util/functions/update_cache_util.js';\nimport doesUserFollow from '../../functions/does_user_follow.js';\nconst { FOLLOW, UNFOLLOW } = Mutations;\nconst { FETCH_USER } = Queries;\nconst { followUpdate, unfollowUpdate } = UpdateCacheUtil;\n\nconst FollowButton = ({\n  feed,\n  user,\n  tag,\n}) => {\n  let [follow] = useMutation(FOLLOW, {\n    update(client, { data }) {\n      var { follow } = data\n      \n      followUpdate(client, follow, FETCH_USER, Cookies.get('currentUser'), user ? 'User' : 'Tag')\n    },\n    onError(error) {\n      console.log(error.message)\n    }\n  });\n\n  let [unfollow] = useMutation(UNFOLLOW, {\n    update(client, { data }) {\n      var { unfollow } = data\n      \n      unfollowUpdate(client, unfollow, FETCH_USER, Cookies.get('currentUser'), user ? 'User' : 'Tag')\n    },\n    onError(error) {\n      console.log(error.message)\n    }\n  });\n\n  let { loading, error, data: currentUser } = useQuery(FETCH_USER, {\n    variables: {\n      query: Cookies.get('currentUser')\n    }\n  })\n\n  if (loading) return 'Loading...';\n  if (error) return `Error: ${error}`;\n  \n  if (doesUserFollow(currentUser.user, user, tag)) {\n    return (\n      <React.Fragment>\n        <form\n          onSubmit={e => {\n            e.preventDefault();\n            unfollow({\n              variables: {\n                user: Cookies.get('currentUser'),\n                item: user ? user._id : tag._id\n              }\n            })\n          }}\n        >\n          <button type='submit'>Unfollow</button>\n        </form>\n      </React.Fragment>\n    )\n  } else {\n    return (\n      <React.Fragment>\n        <form\n          onSubmit={e => {\n            e.preventDefault();\n            follow({\n              variables: {\n                user: Cookies.get('currentUser'),\n                item: user ? user._id : tag._id,\n                itemKind: user ? 'User' : 'Tag'\n              }\n            })\n          }}\n        >\n          <button type='submit'>Follow</button>\n        </form>\n      </React.Fragment>\n    )\n  }\n}\n\nexport default FollowButton;"]},"metadata":{},"sourceType":"module"}