{"ast":null,"code":"var _jsxFileName = \"/Users/johnobrien/Desktop/JOB_Developer/client/src/components/posts/util/components/social/Post_Notes.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useMutation } from '@apollo/client';\nimport { Link } from 'react-router-dom';\nimport Cookies from 'js-cookie';\nimport DOMPurify from 'dompurify';\nimport DeleteComment from '../social/Delete_Comment';\nimport ProfilePic from '../../../../user/util/components/Profile_Pic';\nimport Queries from '../../../../../graphql/queries';\nimport Mutations from '../../../../../graphql/mutations';\nimport FeedUtil from '../../functions/feed_util.js';\nimport UpdateCacheUtil from '../../functions/update_cache_util.js';\nimport PostFormUtil from '../../functions/post_form_util.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  FETCH_LIKES_REPOSTS_AND_COMMENTS\n} = Queries;\nconst {\n  COMMENT_POST\n} = Mutations;\nconst {\n  handlePostNotesScrollOutOfWindow\n} = FeedUtil;\nconst {\n  commentPost\n} = UpdateCacheUtil;\nconst {\n  allowScroll,\n  preventScroll\n} = PostFormUtil;\n\nconst PostNotes = ({\n  post,\n  notesCount,\n  notes,\n  notesActive,\n  setNotesActive\n}) => {\n  _s();\n\n  var [content, setContent] = useState('');\n  useEffect(() => {\n    var el = document.querySelector('.notes');\n\n    if (el) {\n      el.scrollTop = el.scrollHeight;\n    }\n  });\n  useEffect(() => {\n    var scroll = handlePostNotesScrollOutOfWindow(notesActive, setNotesActive);\n    return () => {\n      document.removeEventListener('scroll', scroll);\n    };\n  }, [notesActive, setNotesActive]);\n  useEffect(() => {\n    if (notesActive) {\n      preventScroll(notesActive, document);\n    } else {\n      allowScroll(document);\n    }\n\n    return () => {\n      allowScroll(document);\n    };\n  }, [notesActive]);\n  let [comment] = useMutation(COMMENT_POST, {\n    update(client, {\n      data\n    }) {\n      let {\n        comment\n      } = data;\n      let query = FETCH_LIKES_REPOSTS_AND_COMMENTS;\n      commentPost(client, comment, post, query);\n    },\n\n    onCompleted() {\n      setContent(content = '');\n    }\n\n  });\n\n  const resolveKind = note => {\n    if (note.kind === 'Repost') {\n      return 'Repost';\n    } else if (note.kind === 'Comment') {\n      return 'Comment';\n    } else if (note.kind === 'Like') {\n      return 'Like';\n    }\n  };\n\n  const handleSubmit = () => {\n    let commentData = {};\n    commentData.user = Cookies.get('currentUser');\n    commentData.postAuthorId = post.user._id;\n    commentData.postId = post._id;\n    commentData.content = content;\n    commentData.kind = post.kind;\n    comment({\n      variables: {\n        commentData: commentData\n      }\n    });\n  };\n\n  if (notesActive) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"postNotes\",\n      tabIndex: -1,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"notesHeader\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"backBtn\",\n          src: \"https://img.icons8.com/windows/64/000000/long-arrow-left.png\",\n          alt: \"\",\n          onClick: () => {\n            if (window.innerHeight < 980) {\n              allowScroll(document);\n            }\n\n            setNotesActive(notesActive = false);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [notesCount, \" notes\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"notes\",\n        children: notes.map((n, i) => {\n          var note = resolveKind(n);\n\n          if (note === 'Comment') {\n            return /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"noteProfilePicContainer\",\n                children: /*#__PURE__*/_jsxDEV(ProfilePic, {\n                  user: n.user,\n                  activity: n\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 135,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 132,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"noteContentContainer\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"noteContentHeader\",\n                  children: [/*#__PURE__*/_jsxDEV(Link, {\n                    to: `/view/blog/${n.user.blogName}`,\n                    children: n.user.blogName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 147,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: /*#__PURE__*/_jsxDEV(DeleteComment, {\n                      post: post,\n                      comment: n\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 154,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 153,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 144,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: n.content\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 160,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 19\n              }, this)]\n            }, n._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 17\n            }, this);\n          } else if (note === 'Repost') {\n            var caption;\n            n.repostTrail.forEach(captionObj => {\n              if (captionObj.user._id === n.user._id) {\n                caption = captionObj.caption;\n              }\n            });\n            return /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"noteProfileContainer\",\n                children: /*#__PURE__*/_jsxDEV(ProfilePic, {\n                  user: n.user,\n                  activity: n\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 180,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"noteContentContainer\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"noteContentHeader repost\",\n                  children: [/*#__PURE__*/_jsxDEV(Link, {\n                    className: \"user\",\n                    to: `/view/blog/${n.user.blogName}`,\n                    children: n.user.blogName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 192,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"repostIconAndRepostFromContainer\",\n                    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                      className: \"repostIconHeader\",\n                      src: \"https://img.icons8.com/material-outlined/64/000000/retweet.png\",\n                      alt: \"\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 202,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Link, {\n                      className: \"repostedFrom\",\n                      to: `/view/blog/${n.repostedFrom.blogName}`,\n                      children: n.repostedFrom.blogName\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 208,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 199,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 189,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"noteRepostCaption\",\n                  dangerouslySetInnerHTML: {\n                    __html: DOMPurify.sanitize(caption)\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 217,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 186,\n                columnNumber: 19\n              }, this)]\n            }, n._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 17\n            }, this);\n          } else if (note === 'Like') {\n            return /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"noteProfilePicContainer\",\n                children: /*#__PURE__*/_jsxDEV(ProfilePic, {\n                  user: n.user,\n                  activity: n\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 235,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"noteContentContainer\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"noteContentHeader\",\n                  children: /*#__PURE__*/_jsxDEV(Link, {\n                    to: `/view/blog/${n.user.blogName}`,\n                    children: n.user.blogName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 247,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 244,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"likes this\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 254,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 19\n              }, this)]\n            }, n._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 17\n            }, this);\n          } else {\n            return /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 17\n            }, this);\n          }\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"commentInputContainer\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: content,\n          placeholder: 'Speak your mind...',\n          onChange: e => {\n            setContent(content = e.target.value);\n          },\n          onKeyDown: e => {\n            if (e.key === 'Enter') {\n              handleSubmit();\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          disabled: !content,\n          onClick: () => {\n            handleSubmit();\n          },\n          children: \"Reply\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 7\n    }, this);\n  }\n};\n\n_s(PostNotes, \"EkoaU+CIF7rkbWv44/gCSNstC7k=\", false, function () {\n  return [useMutation];\n});\n\n_c = PostNotes;\nexport default PostNotes;\n\nvar _c;\n\n$RefreshReg$(_c, \"PostNotes\");","map":{"version":3,"sources":["/Users/johnobrien/Desktop/JOB_Developer/client/src/components/posts/util/components/social/Post_Notes.js"],"names":["React","useState","useEffect","useMutation","Link","Cookies","DOMPurify","DeleteComment","ProfilePic","Queries","Mutations","FeedUtil","UpdateCacheUtil","PostFormUtil","FETCH_LIKES_REPOSTS_AND_COMMENTS","COMMENT_POST","handlePostNotesScrollOutOfWindow","commentPost","allowScroll","preventScroll","PostNotes","post","notesCount","notes","notesActive","setNotesActive","content","setContent","el","document","querySelector","scrollTop","scrollHeight","scroll","removeEventListener","comment","update","client","data","query","onCompleted","resolveKind","note","kind","handleSubmit","commentData","user","get","postAuthorId","_id","postId","variables","window","innerHeight","map","n","i","blogName","caption","repostTrail","forEach","captionObj","repostedFrom","__html","sanitize","e","target","value","key"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,WAAT,QAA4B,gBAA5B;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,SAAP,MAAsB,WAAtB;AAEA,OAAOC,aAAP,MAA0B,0BAA1B;AACA,OAAOC,UAAP,MAAuB,8CAAvB;AAEA,OAAOC,OAAP,MAAoB,gCAApB;AACA,OAAOC,SAAP,MAAsB,kCAAtB;AACA,OAAOC,QAAP,MAAqB,8BAArB;AACA,OAAOC,eAAP,MAA4B,sCAA5B;AACA,OAAOC,YAAP,MAAyB,mCAAzB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAuCL,OAA7C;AACA,MAAM;AAAEM,EAAAA;AAAF,IAAmBL,SAAzB;AACA,MAAM;AAAEM,EAAAA;AAAF,IAAuCL,QAA7C;AACA,MAAM;AAAEM,EAAAA;AAAF,IAAkBL,eAAxB;AACA,MAAM;AAAEM,EAAAA,WAAF;AAAeC,EAAAA;AAAf,IAAiCN,YAAvC;;AAEA,MAAMO,SAAS,GAAG,CAAC;AACjBC,EAAAA,IADiB;AAEjBC,EAAAA,UAFiB;AAGjBC,EAAAA,KAHiB;AAIjBC,EAAAA,WAJiB;AAKjBC,EAAAA;AALiB,CAAD,KAMZ;AAAA;;AACJ,MAAI,CAACC,OAAD,EAAUC,UAAV,IAAwB1B,QAAQ,CAAC,EAAD,CAApC;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI0B,EAAE,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAT;;AAEA,QAAIF,EAAJ,EAAQ;AACNA,MAAAA,EAAE,CAACG,SAAH,GAAeH,EAAE,CAACI,YAAlB;AACD;AACF,GANQ,CAAT;AAQA9B,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI+B,MAAM,GAAGjB,gCAAgC,CAC3CQ,WAD2C,EAE3CC,cAF2C,CAA7C;AAKA,WAAO,MAAM;AACXI,MAAAA,QAAQ,CAACK,mBAAT,CAA6B,QAA7B,EAAuCD,MAAvC;AACD,KAFD;AAGD,GATQ,EASN,CAACT,WAAD,EAAcC,cAAd,CATM,CAAT;AAWAvB,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIsB,WAAJ,EAAiB;AACfL,MAAAA,aAAa,CAACK,WAAD,EAAcK,QAAd,CAAb;AACD,KAFD,MAEO;AACLX,MAAAA,WAAW,CAACW,QAAD,CAAX;AACD;;AAED,WAAO,MAAM;AACXX,MAAAA,WAAW,CAACW,QAAD,CAAX;AACD,KAFD;AAGD,GAVQ,EAUN,CAACL,WAAD,CAVM,CAAT;AAYA,MAAI,CAACW,OAAD,IAAYhC,WAAW,CAACY,YAAD,EAAe;AACxCqB,IAAAA,MAAM,CAACC,MAAD,EAAS;AAAEC,MAAAA;AAAF,KAAT,EAAmB;AACvB,UAAI;AAAEH,QAAAA;AAAF,UAAcG,IAAlB;AACA,UAAIC,KAAK,GAAGzB,gCAAZ;AAEAG,MAAAA,WAAW,CAACoB,MAAD,EAASF,OAAT,EAAkBd,IAAlB,EAAwBkB,KAAxB,CAAX;AACD,KANuC;;AAOxCC,IAAAA,WAAW,GAAG;AACZb,MAAAA,UAAU,CAACD,OAAO,GAAG,EAAX,CAAV;AACD;;AATuC,GAAf,CAA3B;;AAYA,QAAMe,WAAW,GAAIC,IAAD,IAAU;AAC5B,QAAIA,IAAI,CAACC,IAAL,KAAc,QAAlB,EAA4B;AAC1B,aAAO,QAAP;AACD,KAFD,MAEO,IAAID,IAAI,CAACC,IAAL,KAAc,SAAlB,EAA6B;AAClC,aAAO,SAAP;AACD,KAFM,MAEA,IAAID,IAAI,CAACC,IAAL,KAAc,MAAlB,EAA0B;AAC/B,aAAO,MAAP;AACD;AACF,GARD;;AAUA,QAAMC,YAAY,GAAG,MAAM;AACzB,QAAIC,WAAW,GAAG,EAAlB;AACAA,IAAAA,WAAW,CAACC,IAAZ,GAAmBzC,OAAO,CAAC0C,GAAR,CAAY,aAAZ,CAAnB;AACAF,IAAAA,WAAW,CAACG,YAAZ,GAA2B3B,IAAI,CAACyB,IAAL,CAAUG,GAArC;AACAJ,IAAAA,WAAW,CAACK,MAAZ,GAAqB7B,IAAI,CAAC4B,GAA1B;AACAJ,IAAAA,WAAW,CAACnB,OAAZ,GAAsBA,OAAtB;AACAmB,IAAAA,WAAW,CAACF,IAAZ,GAAmBtB,IAAI,CAACsB,IAAxB;AAEAR,IAAAA,OAAO,CAAC;AACNgB,MAAAA,SAAS,EAAE;AACTN,QAAAA,WAAW,EAAEA;AADJ;AADL,KAAD,CAAP;AAKD,GAbD;;AAeA,MAAIrB,WAAJ,EAAiB;AACf,wBACE;AACE,MAAA,SAAS,EAAC,WADZ;AAEE,MAAA,QAAQ,EAAE,CAAC,CAFb;AAAA,8BAIE;AACE,QAAA,SAAS,EAAC,aADZ;AAAA,gCAGE;AACE,UAAA,SAAS,EAAC,SADZ;AAEE,UAAA,GAAG,EAAC,8DAFN;AAGE,UAAA,GAAG,EAAC,EAHN;AAIE,UAAA,OAAO,EAAE,MAAM;AACb,gBAAI4B,MAAM,CAACC,WAAP,GAAqB,GAAzB,EAA8B;AAC5BnC,cAAAA,WAAW,CAACW,QAAD,CAAX;AACD;;AAEDJ,YAAAA,cAAc,CAACD,WAAW,GAAG,KAAf,CAAd;AACD;AAVH;AAAA;AAAA;AAAA;AAAA,gBAHF,eAeE;AAAA,qBAAOF,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA,gBAfF;AAAA;AAAA;AAAA;AAAA;AAAA,cAJF,eAsBE;AACE,QAAA,SAAS,EAAC,OADZ;AAAA,kBAGGC,KAAK,CAAC+B,GAAN,CAAU,CAACC,CAAD,EAAIC,CAAJ,KAAU;AACnB,cAAId,IAAI,GAAGD,WAAW,CAACc,CAAD,CAAtB;;AACA,cAAIb,IAAI,KAAK,SAAb,EAAwB;AACtB,gCACE;AAAA,sCAGE;AACE,gBAAA,SAAS,EAAC,yBADZ;AAAA,uCAGE,QAAC,UAAD;AACE,kBAAA,IAAI,EAAEa,CAAC,CAACT,IADV;AAEE,kBAAA,QAAQ,EAAES;AAFZ;AAAA;AAAA;AAAA;AAAA;AAHF;AAAA;AAAA;AAAA;AAAA,sBAHF,eAYE;AACE,gBAAA,SAAS,EAAC,sBADZ;AAAA,wCAGE;AACE,kBAAA,SAAS,EAAC,mBADZ;AAAA,0CAGE,QAAC,IAAD;AACE,oBAAA,EAAE,EAAG,cAAaA,CAAC,CAACT,IAAF,CAAOW,QAAS,EADpC;AAAA,8BAGGF,CAAC,CAACT,IAAF,CAAOW;AAHV;AAAA;AAAA;AAAA;AAAA,0BAHF,eASE;AAAA,2CACE,QAAC,aAAD;AACE,sBAAA,IAAI,EAAEpC,IADR;AAEE,sBAAA,OAAO,EAAEkC;AAFX;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,0BATF;AAAA;AAAA;AAAA;AAAA;AAAA,wBAHF,eAmBE;AAAA,4BAAIA,CAAC,CAAC7B;AAAN;AAAA;AAAA;AAAA;AAAA,wBAnBF;AAAA;AAAA;AAAA;AAAA;AAAA,sBAZF;AAAA,eACO6B,CAAC,CAACN,GADT;AAAA;AAAA;AAAA;AAAA,oBADF;AAoCD,WArCD,MAqCO,IAAIP,IAAI,KAAK,QAAb,EAAuB;AAE5B,gBAAIgB,OAAJ;AACAH,YAAAA,CAAC,CAACI,WAAF,CAAcC,OAAd,CAAsBC,UAAU,IAAI;AAClC,kBAAIA,UAAU,CAACf,IAAX,CAAgBG,GAAhB,KAAwBM,CAAC,CAACT,IAAF,CAAOG,GAAnC,EAAwC;AACtCS,gBAAAA,OAAO,GAAGG,UAAU,CAACH,OAArB;AACD;AACF,aAJD;AAMA,gCACE;AAAA,sCAGE;AACE,gBAAA,SAAS,EAAC,sBADZ;AAAA,uCAGE,QAAC,UAAD;AACE,kBAAA,IAAI,EAAEH,CAAC,CAACT,IADV;AAEE,kBAAA,QAAQ,EAAES;AAFZ;AAAA;AAAA;AAAA;AAAA;AAHF;AAAA;AAAA;AAAA;AAAA,sBAHF,eAYE;AACE,gBAAA,SAAS,EAAC,sBADZ;AAAA,wCAGE;AACE,kBAAA,SAAS,EAAC,0BADZ;AAAA,0CAGE,QAAC,IAAD;AACE,oBAAA,SAAS,EAAC,MADZ;AAEE,oBAAA,EAAE,EAAG,cAAaA,CAAC,CAACT,IAAF,CAAOW,QAAS,EAFpC;AAAA,8BAIGF,CAAC,CAACT,IAAF,CAAOW;AAJV;AAAA;AAAA;AAAA;AAAA,0BAHF,eAUE;AACE,oBAAA,SAAS,EAAC,kCADZ;AAAA,4CAGE;AACE,sBAAA,SAAS,EAAC,kBADZ;AAEE,sBAAA,GAAG,EAAC,gEAFN;AAGE,sBAAA,GAAG,EAAC;AAHN;AAAA;AAAA;AAAA;AAAA,4BAHF,eASE,QAAC,IAAD;AACE,sBAAA,SAAS,EAAC,cADZ;AAEE,sBAAA,EAAE,EAAG,cAAaF,CAAC,CAACO,YAAF,CAAeL,QAAS,EAF5C;AAAA,gCAIGF,CAAC,CAACO,YAAF,CAAeL;AAJlB;AAAA;AAAA;AAAA;AAAA,4BATF;AAAA;AAAA;AAAA;AAAA;AAAA,0BAVF;AAAA;AAAA;AAAA;AAAA;AAAA,wBAHF,eA+BE;AACE,kBAAA,SAAS,EAAC,mBADZ;AAEE,kBAAA,uBAAuB,EAAE;AACvBM,oBAAAA,MAAM,EAAEzD,SAAS,CAAC0D,QAAV,CAAmBN,OAAnB;AADe;AAF3B;AAAA;AAAA;AAAA;AAAA,wBA/BF;AAAA;AAAA;AAAA;AAAA;AAAA,sBAZF;AAAA,eACOH,CAAC,CAACN,GADT;AAAA;AAAA;AAAA;AAAA,oBADF;AAqDD,WA9DM,MA8DA,IAAIP,IAAI,KAAK,MAAb,EAAqB;AAC1B,gCACE;AAAA,sCAIE;AACE,gBAAA,SAAS,EAAC,yBADZ;AAAA,uCAGE,QAAC,UAAD;AACE,kBAAA,IAAI,EAAEa,CAAC,CAACT,IADV;AAEE,kBAAA,QAAQ,EAAES;AAFZ;AAAA;AAAA;AAAA;AAAA;AAHF;AAAA;AAAA;AAAA;AAAA,sBAJF,eAaE;AACE,gBAAA,SAAS,EAAC,sBADZ;AAAA,wCAGE;AACE,kBAAA,SAAS,EAAC,mBADZ;AAAA,yCAGE,QAAC,IAAD;AACE,oBAAA,EAAE,EAAG,cAAaA,CAAC,CAACT,IAAF,CAAOW,QAAS,EADpC;AAAA,8BAGGF,CAAC,CAACT,IAAF,CAAOW;AAHV;AAAA;AAAA;AAAA;AAAA;AAHF;AAAA;AAAA;AAAA;AAAA,wBAHF,eAaE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAbF;AAAA;AAAA;AAAA;AAAA;AAAA,sBAbF;AAAA,eACOF,CAAC,CAACN,GADT;AAAA;AAAA;AAAA;AAAA,oBADF;AA+BD,WAhCM,MAgCA;AACL,gCACE;AAAA;AAAA;AAAA;AAAA,oBADF;AAID;AACF,SA3IA;AAHH;AAAA;AAAA;AAAA;AAAA,cAtBF,eAuKE;AACE,QAAA,SAAS,EAAC,uBADZ;AAAA,gCAGE;AACE,UAAA,KAAK,EAAEvB,OADT;AAEE,UAAA,WAAW,EAAE,oBAFf;AAGE,UAAA,QAAQ,EAAEuC,CAAC,IAAI;AACbtC,YAAAA,UAAU,CAACD,OAAO,GAAGuC,CAAC,CAACC,MAAF,CAASC,KAApB,CAAV;AACD,WALH;AAME,UAAA,SAAS,EAAEF,CAAC,IAAI;AACd,gBAAIA,CAAC,CAACG,GAAF,KAAU,OAAd,EAAuB;AACrBxB,cAAAA,YAAY;AACb;AACF;AAVH;AAAA;AAAA;AAAA;AAAA,gBAHF,eAgBE;AACE,UAAA,IAAI,EAAC,QADP;AAEE,UAAA,QAAQ,EAAE,CAAClB,OAFb;AAGE,UAAA,OAAO,EAAE,MAAM;AACbkB,YAAAA,YAAY;AACb,WALH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAhBF;AAAA;AAAA;AAAA;AAAA;AAAA,cAvKF;AAAA;AAAA;AAAA;AAAA;AAAA,YADF;AAoMD,GArMD,MAqMO;AACL,wBACE;AAAA;AAAA;AAAA;AAAA,YADF;AAID;AACF,CAxRD;;GAAMxB,S;UAwCYjB,W;;;KAxCZiB,S;AA0RN,eAAeA,SAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useMutation } from '@apollo/client';\nimport { Link } from 'react-router-dom';\nimport Cookies from 'js-cookie';\nimport DOMPurify from 'dompurify';\n\nimport DeleteComment from '../social/Delete_Comment'\nimport ProfilePic from '../../../../user/util/components/Profile_Pic';\n\nimport Queries from '../../../../../graphql/queries';\nimport Mutations from '../../../../../graphql/mutations';\nimport FeedUtil from '../../functions/feed_util.js';\nimport UpdateCacheUtil from '../../functions/update_cache_util.js';\nimport PostFormUtil from '../../functions/post_form_util.js';\nconst { FETCH_LIKES_REPOSTS_AND_COMMENTS } = Queries;\nconst { COMMENT_POST } = Mutations;\nconst { handlePostNotesScrollOutOfWindow } = FeedUtil;\nconst { commentPost } = UpdateCacheUtil;\nconst { allowScroll, preventScroll } = PostFormUtil;\n\nconst PostNotes = ({\n  post,\n  notesCount,\n  notes, \n  notesActive,\n  setNotesActive, \n}) => {\n  var [content, setContent] = useState('')\n\n  useEffect(() => {\n    var el = document.querySelector('.notes')\n\n    if (el) {\n      el.scrollTop = el.scrollHeight\n    }\n  })\n\n  useEffect(() => {\n    var scroll = handlePostNotesScrollOutOfWindow(\n      notesActive,\n      setNotesActive\n    )\n\n    return () => {\n      document.removeEventListener('scroll', scroll)\n    }\n  }, [notesActive, setNotesActive])\n\n  useEffect(() => {\n    if (notesActive) {\n      preventScroll(notesActive, document)\n    } else {\n      allowScroll(document)\n    }\n\n    return () => {\n      allowScroll(document)\n    }\n  }, [notesActive])\n\n  let [comment] = useMutation(COMMENT_POST, {\n    update(client, { data }) {\n      let { comment } = data;\n      let query = FETCH_LIKES_REPOSTS_AND_COMMENTS;\n\n      commentPost(client, comment, post, query)\n    },\n    onCompleted() {\n      setContent(content = '')\n    }\n  })\n\n  const resolveKind = (note) => {\n    if (note.kind === 'Repost') {\n      return 'Repost'\n    } else if (note.kind === 'Comment') {\n      return 'Comment'\n    } else if (note.kind === 'Like') {\n      return 'Like'\n    }\n  }\n\n  const handleSubmit = () => {\n    let commentData = {}\n    commentData.user = Cookies.get('currentUser')\n    commentData.postAuthorId = post.user._id\n    commentData.postId = post._id\n    commentData.content = content\n    commentData.kind = post.kind\n\n    comment({\n      variables: {\n        commentData: commentData\n      }\n    })\n  }\n  \n  if (notesActive) {\n    return (\n      <div\n        className='postNotes'\n        tabIndex={-1}\n      >\n        <div\n          className='notesHeader'\n        >\n          <img\n            className='backBtn'\n            src=\"https://img.icons8.com/windows/64/000000/long-arrow-left.png\"\n            alt=''\n            onClick={() => {\n              if (window.innerHeight < 980) {\n                allowScroll(document)\n              }\n\n              setNotesActive(notesActive = false)              \n            }}\n          />\n          <span>{notesCount} notes</span>\n        </div>\n\n        <ul\n          className='notes'\n        >\n          {notes.map((n, i) => {\n            var note = resolveKind(n)\n            if (note === 'Comment') {\n              return (\n                <li\n                  key={n._id}\n                >\n                  <div\n                    className='noteProfilePicContainer'\n                  >\n                    <ProfilePic\n                      user={n.user}\n                      activity={n}\n                    />\n                  </div>\n\n                  <div\n                    className='noteContentContainer'\n                  >\n                    <div\n                      className='noteContentHeader'\n                    >\n                      <Link\n                        to={`/view/blog/${n.user.blogName}`}\n                      >\n                        {n.user.blogName}\n                      </Link>\n\n                      <div>\n                        <DeleteComment\n                          post={post}\n                          comment={n}\n                        />\n                      </div>\n                    </div>\n                    <p>{n.content}</p>\n                  </div>\n                </li>\n              )\n            } else if (note === 'Repost') {\n\n              var caption\n              n.repostTrail.forEach(captionObj => {\n                if (captionObj.user._id === n.user._id) {\n                  caption = captionObj.caption\n                }\n              })\n\n              return (\n                <li\n                  key={n._id}\n                >\n                  <div\n                    className='noteProfileContainer'\n                  >\n                    <ProfilePic \n                      user={n.user}\n                      activity={n}\n                    />\n                  </div>\n\n                  <div\n                    className='noteContentContainer'\n                  >\n                    <div\n                      className='noteContentHeader repost'\n                    >\n                      <Link\n                        className='user'\n                        to={`/view/blog/${n.user.blogName}`}\n                      >\n                        {n.user.blogName}\n                      </Link>\n\n                      <div\n                        className='repostIconAndRepostFromContainer'\n                      >\n                        <img\n                          className='repostIconHeader'\n                          src=\"https://img.icons8.com/material-outlined/64/000000/retweet.png\"\n                          alt=''\n                        />\n\n                        <Link\n                          className='repostedFrom'\n                          to={`/view/blog/${n.repostedFrom.blogName}`}\n                        >\n                          {n.repostedFrom.blogName}\n                        </Link>\n                      </div>\n                    </div>\n                    \n                    <div\n                      className='noteRepostCaption'\n                      dangerouslySetInnerHTML={{ \n                        __html: DOMPurify.sanitize(caption)\n                      }}\n                    />\n                  </div>\n                </li>\n              )\n            } else if (note === 'Like') {\n              return (\n                <li\n                  key={n._id}\n                >\n\n                  <div\n                    className='noteProfilePicContainer'\n                  >\n                    <ProfilePic\n                      user={n.user}\n                      activity={n}\n                    />\n                  </div>\n\n                  <div\n                    className='noteContentContainer'\n                  >\n                    <div\n                      className='noteContentHeader'\n                    >\n                      <Link\n                        to={`/view/blog/${n.user.blogName}`}\n                      >\n                        {n.user.blogName}\n                      </Link>\n                    </div>\n\n                    <p>likes this</p>\n                  </div>\n                </li>\n              )\n            } else {\n              return (\n                <div>\n                </div>\n              )\n            }\n          })}\n        </ul>\n\n        <div\n          className='commentInputContainer'\n        > \n          <textarea\n            value={content}\n            placeholder={'Speak your mind...'}\n            onChange={e => {\n              setContent(content = e.target.value)\n            }}\n            onKeyDown={e => {\n              if (e.key === 'Enter') {\n                handleSubmit()\n              }\n            }}\n          ></textarea>\n\n          <button\n            type='button'\n            disabled={!content}\n            onClick={() => {\n              handleSubmit() \n            }}\n          >\n            Reply\n          </button>\n        </div>\n      </div>\n    )\n  } else {\n    return (\n      <div>\n      </div>\n    )\n  }\n}\n\nexport default PostNotes;"]},"metadata":{},"sourceType":"module"}