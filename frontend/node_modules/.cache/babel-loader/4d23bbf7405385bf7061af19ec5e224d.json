{"ast":null,"code":"import _slicedToArray from\"/Users/johnobrien/Desktop/Rumblr_PROD/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useRef,useEffect}from'react';import{useQuery,useMutation}from'@apollo/client';import Cookies from'js-cookie';import PostNotes from'../../util/components/social/Post_Notes.js';import PostOptions from'../../util/components/social/Post_Options.js';import RepostForm from'../../util/components/social/Repost_Form';import PostShowUtil from'../../util/functions/post_show_util.js';import Queries from'../../../../graphql/queries';import Mutations from'../../../../graphql/mutations';import PostFormUtil from'../../util/functions/post_form_util.js';import UpdateCacheUtil from'../../util/functions/update_cache_util.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var postHeader=PostShowUtil.postHeader,postBody=PostShowUtil.postBody,repostFooter=PostShowUtil.repostFooter,postTags=PostShowUtil.postTags;var allowScroll=PostFormUtil.allowScroll,preventScroll=PostFormUtil.preventScroll;var postDelete=UpdateCacheUtil.postDelete;var FETCH_LIKES_REPOSTS_AND_COMMENTS=Queries.FETCH_LIKES_REPOSTS_AND_COMMENTS,FETCH_USER_FEED=Queries.FETCH_USER_FEED;var DELETE_POST=Mutations.DELETE_POST;var PostShow=function PostShow(_ref){var post=_ref.post,repostFormBool=_ref.repostFormBool,update=_ref.update,setUpdate=_ref.setUpdate,toggleUpdate=_ref.toggleUpdate,discover=_ref.discover,radar=_ref.radar,repostCaption=_ref.repostCaption,setRepostCaption=_ref.setRepostCaption;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),notesActive=_useState2[0],setNotesActive=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),repostActive=_useState4[0],setRepostActive=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),confirmDelete=_useState6[0],setConfirmDelete=_useState6[1];var doesUserFollowUserRef=useRef(false);useEffect(function(){if(confirmDelete){preventScroll(confirmDelete,document);}},[confirmDelete]);var _useMutation=useMutation(DELETE_POST,{update:function update(client,_ref2){var data=_ref2.data;var deletePost=data.deletePost;var currentUser=Cookies.get('currentUser');var query=FETCH_USER_FEED;postDelete(client,post,deletePost,currentUser,query);}}),_useMutation2=_slicedToArray(_useMutation,1),deletePost=_useMutation2[0];var _useQuery=useQuery(FETCH_LIKES_REPOSTS_AND_COMMENTS,{variables:{postId:post._id}}),loading=_useQuery.loading,error=_useQuery.error,data=_useQuery.data;var toggleNotes=function toggleNotes(){if(notesActive){setNotesActive(notesActive=false);}else{setNotesActive(notesActive=true);}};var notesAndOptions=function notesAndOptions(){if(!repostFormBool){return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(PostNotes,{post:post,notesCount:data.fetchLikesRepostsAndComments.length,notes:data.fetchLikesRepostsAndComments,notesActive:notesActive,setNotesActive:setNotesActive}),/*#__PURE__*/_jsx(PostOptions,{post:post,notesCount:data.fetchLikesRepostsAndComments.length,notesActive:notesActive,setNotesActive:setNotesActive,toggleNotes:toggleNotes,update:update,setUpdate:setUpdate,toggleUpdate:toggleUpdate,repostActive:repostActive,setRepostActive:setRepostActive,confirmDelete:confirmDelete,setConfirmDelete:setConfirmDelete})]});}};var renderConfirmDelete=function renderConfirmDelete(){if(confirmDelete){return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"confirmDeleteModal\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"confirmDelete\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Are you sure you want to delete this post?\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"cancelBtn\",onClick:function onClick(){allowScroll(document);setConfirmDelete(confirmDelete=false);},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{className:\"deleteBtn\",onClick:function onClick(e){allowScroll(document);deletePost({variables:{post:post}});setConfirmDelete(confirmDelete=false);},children:\"Ok\"})]})]})]});}};if(loading)return'Loading...';if(error)return\"Error: \".concat(error);switch(post){case null:return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"p\",{children:\"Sorry, looks like this post no longer exists\"})});default:return/*#__PURE__*/_jsxs(React.Fragment,{children:[postHeader(post,discover,radar,doesUserFollowUserRef,repostFormBool),postBody(post),repostFooter(post,update,repostCaption,setRepostCaption),postTags(post),notesAndOptions(),renderConfirmDelete(),/*#__PURE__*/_jsx(RepostForm,{post:post,repostActive:repostActive,setRepostActive:setRepostActive})]});}};export default PostShow;","map":{"version":3,"sources":["/Users/johnobrien/Desktop/Rumblr_PROD/client/src/components/posts/types/showOrUpdate/PostShow.js"],"names":["React","useState","useRef","useEffect","useQuery","useMutation","Cookies","PostNotes","PostOptions","RepostForm","PostShowUtil","Queries","Mutations","PostFormUtil","UpdateCacheUtil","postHeader","postBody","repostFooter","postTags","allowScroll","preventScroll","postDelete","FETCH_LIKES_REPOSTS_AND_COMMENTS","FETCH_USER_FEED","DELETE_POST","PostShow","post","repostFormBool","update","setUpdate","toggleUpdate","discover","radar","repostCaption","setRepostCaption","notesActive","setNotesActive","repostActive","setRepostActive","confirmDelete","setConfirmDelete","doesUserFollowUserRef","document","client","data","deletePost","currentUser","get","query","variables","postId","_id","loading","error","toggleNotes","notesAndOptions","fetchLikesRepostsAndComments","length","renderConfirmDelete","e"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { useQuery, useMutation } from '@apollo/client';\nimport Cookies from 'js-cookie';\n\nimport PostNotes from '../../util/components/social/Post_Notes.js';\nimport PostOptions from '../../util/components/social/Post_Options.js';\nimport RepostForm from '../../util/components/social/Repost_Form';\n\nimport PostShowUtil from '../../util/functions/post_show_util.js';\nimport Queries from '../../../../graphql/queries';\nimport Mutations from '../../../../graphql/mutations';\nimport PostFormUtil from '../../util/functions/post_form_util.js';\nimport UpdateCacheUtil from '../../util/functions/update_cache_util.js';\nconst { postHeader, postBody, repostFooter, postTags } = PostShowUtil;\nconst { allowScroll, preventScroll } = PostFormUtil;\nconst { postDelete } = UpdateCacheUtil;\nconst { FETCH_LIKES_REPOSTS_AND_COMMENTS, FETCH_USER_FEED } = Queries;\nconst { DELETE_POST } = Mutations;\n\n\nconst PostShow = ({ \n  post, \n  repostFormBool,\n  update, \n  setUpdate,\n  toggleUpdate,\n  discover, \n  radar,\n  repostCaption,\n  setRepostCaption\n}) => {\n  let [notesActive, setNotesActive] = useState(false)\n  let [repostActive, setRepostActive] = useState(false)\n  let [confirmDelete, setConfirmDelete] = useState(false)\n  let doesUserFollowUserRef = useRef(false)\n\n  useEffect(() => {\n    if (confirmDelete) {\n\n      preventScroll(confirmDelete, document)\n\n    }\n    \n  }, [confirmDelete])\n\n  let [deletePost] = useMutation(DELETE_POST, {\n    update(client, { data }) {\n      const { deletePost } = data;\n      var currentUser = Cookies.get('currentUser')\n      var query = FETCH_USER_FEED\n    \n      postDelete(\n        client, post, deletePost,\n        currentUser, query\n      )\n    }\n  })\n\n  let { loading, error, data } = useQuery(FETCH_LIKES_REPOSTS_AND_COMMENTS, {\n    variables: {\n      postId: post._id\n    }\n  })\n\n  const toggleNotes = () => {\n    if (notesActive) {\n      setNotesActive(notesActive = false)\n    } else {\n      setNotesActive(notesActive = true)\n    }\n  }\n\n  const notesAndOptions = () => {\n    if (!repostFormBool) {\n      return (\n        <React.Fragment>\n          <PostNotes\n            post={post}\n            notesCount={data.fetchLikesRepostsAndComments.length}\n            notes={data.fetchLikesRepostsAndComments}\n            notesActive={notesActive}\n            setNotesActive={setNotesActive}\n          />\n      \n          <PostOptions\n            post={post}\n            notesCount={data.fetchLikesRepostsAndComments.length}\n            notesActive={notesActive}\n            setNotesActive={setNotesActive}\n            toggleNotes={toggleNotes}\n            update={update}\n            setUpdate={setUpdate}\n            toggleUpdate={toggleUpdate}\n            repostActive={repostActive}\n            setRepostActive={setRepostActive}\n            confirmDelete={confirmDelete}\n            setConfirmDelete={setConfirmDelete}\n          />\n        </React.Fragment>\n      )\n    }\n  }\n\n  const renderConfirmDelete = () => {\n    if (confirmDelete) {\n      return (\n        <React.Fragment>\n          <div className='confirmDeleteModal' />\n          <div\n            className='confirmDelete'\n          >\n            <p>Are you sure you want to delete this post?</p>\n\n            <div>\n              <button\n                className='cancelBtn'\n                onClick={() => {\n                  allowScroll(document)\n                  setConfirmDelete(confirmDelete = false)\n                }}\n              >\n                Cancel\n              </button>\n\n              <button\n                className='deleteBtn'\n                onClick={e => {\n                  allowScroll(document)\n                  deletePost({\n                    variables: {\n                      post: post\n                    }\n                  })\n                  setConfirmDelete(confirmDelete = false)\n                }}\n              >\n                Ok\n              </button> \n            </div>\n          </div>\n        </React.Fragment>\n      )\n    }\n  }\n\n  if (loading) return 'Loading...';\n  if (error) return `Error: ${error}`\n  \n  switch(post) {\n    case null:\n      return (\n        <div>\n          <p>Sorry, looks like this post no longer exists</p>\n        </div>\n      )\n    default:\n      return (\n        <React.Fragment>\n            {postHeader(post, discover, radar, doesUserFollowUserRef, repostFormBool)}\n        \n            {postBody(post)}\n        \n            {repostFooter(post, update, repostCaption, setRepostCaption)}\n        \n            {postTags(post)}\n\n            {notesAndOptions()}\n\n            {renderConfirmDelete()}\n\n            <RepostForm\n              post={post}\n              repostActive={repostActive}\n              setRepostActive={setRepostActive}\n            />\n        </React.Fragment>\n      )\n  }\n}\n\nexport default PostShow;"]},"metadata":{},"sourceType":"module"}