{"ast":null,"code":"import React,{useRef,useEffect}from'react';import{useQuery,useApolloClient}from'@apollo/client';import{useHistory}from'react-router-dom';import Cookies from'js-cookie';import UserResult from'../search/resultTypes/User_Result';import CheckOutTheseBlogs from'../dashboard/util/Check_Out_These_Blogs';import Queries from'../../graphql/queries.js';import FeedUtil from'../posts/util/functions/feed_util.js';import ActivityUtil from'../nav/util/activity_util.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var handleActivity=ActivityUtil.handleActivity,handleTimeAgo=ActivityUtil.handleTimeAgo;var FETCH_USER_FOLLOWERS=Queries.FETCH_USER_FOLLOWERS,FETCH_FOLLOWED_USERS=Queries.FETCH_FOLLOWED_USERS,FETCH_ALL_ACTIVITY=Queries.FETCH_ALL_ACTIVITY;var infiniteScroll=FeedUtil.infiniteScroll,updateCacheInfScrollUserFollowers=FeedUtil.updateCacheInfScrollUserFollowers,updateCacheInfScrollFollowedUsers=FeedUtil.updateCacheInfScrollFollowedUsers,handleData=FeedUtil.handleData,setgqlQueryUserFollowedOrFollowingOrActivity=FeedUtil.setgqlQueryUserFollowedOrFollowingOrActivity;var UserFollowersOrFollowingFeed=function UserFollowersOrFollowingFeed(){var feedArr=useRef([]);var timeAgoRef=useRef([]);var fetchMoreDiv=useRef(null);var cursorId=useRef(null);var fetchMoreDivId=useRef('#fetchMoreFollowers');var gqlQuery=useRef(FETCH_USER_FOLLOWERS);var query=useRef(Cookies.get('currentUser'));var endOfPosts=useRef(false);var client=useApolloClient();var history=useHistory();setgqlQueryUserFollowedOrFollowingOrActivity(history.location.pathname,gqlQuery,FETCH_USER_FOLLOWERS,FETCH_FOLLOWED_USERS,FETCH_ALL_ACTIVITY);useEffect(function(){var scroll;if(history.location.pathname==='/followers'){scroll=infiniteScroll(client,updateCacheInfScrollUserFollowers,query,gqlQuery,cursorId,fetchMoreDiv,fetchMoreDivId);}else{scroll=infiniteScroll(client,updateCacheInfScrollFollowedUsers,query,gqlQuery,cursorId,fetchMoreDiv,fetchMoreDivId);}return function(){document.removeEventListener('scroll',scroll);timeAgoRef.current=[];refetch();};//eslint-disable-next-line\n},[]);var _useQuery=useQuery(gqlQuery.current,{variables:{query:Cookies.get('currentUser'),cursorId:null}}),loading=_useQuery.loading,error=_useQuery.error,data=_useQuery.data,refetch=_useQuery.refetch;if(loading)return'Loading...';if(error)return\"Error: \".concat(error);handleData(data,feedArr,cursorId,endOfPosts);var handleHeader=function handleHeader(){if(history.location.pathname==='/followers'){return/*#__PURE__*/_jsx(\"h1\",{children:\"Followers\"});}else if(history.location.pathname==='/following'){return/*#__PURE__*/_jsx(\"h1\",{children:\"Following\"});}else{return/*#__PURE__*/_jsx(\"h1\",{children:\"Activity\"});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"followContainer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"outerContainer\",children:[handleHeader(),/*#__PURE__*/_jsx(\"div\",{className:history.location.pathname==='/activity'?'activity':'followFeedContainer',children:feedArr.current.map(function(followOrActivity,i){if(history.location.pathname==='/activity'){return/*#__PURE__*/_jsxs(\"div\",{children:[handleTimeAgo(followOrActivity,timeAgoRef),handleActivity(followOrActivity)]},followOrActivity._id);}else{var user=followOrActivity.hasOwnProperty('follows')?followOrActivity.follows:followOrActivity.user;return/*#__PURE__*/_jsx(\"div\",{className:\"followResult\",children:/*#__PURE__*/_jsx(UserResult,{user:user})},user._id);}})}),/*#__PURE__*/_jsx(\"div\",{id:\"fetchMoreFollowers\"})]}),/*#__PURE__*/_jsx(CheckOutTheseBlogs,{})]});};export default UserFollowersOrFollowingFeed;","map":{"version":3,"sources":["/Users/johnobrien/Desktop/Rumblr_PROD/client/src/components/feeds/User_Followers_Or_Following_Or_Activity_Feed.js"],"names":["React","useRef","useEffect","useQuery","useApolloClient","useHistory","Cookies","UserResult","CheckOutTheseBlogs","Queries","FeedUtil","ActivityUtil","handleActivity","handleTimeAgo","FETCH_USER_FOLLOWERS","FETCH_FOLLOWED_USERS","FETCH_ALL_ACTIVITY","infiniteScroll","updateCacheInfScrollUserFollowers","updateCacheInfScrollFollowedUsers","handleData","setgqlQueryUserFollowedOrFollowingOrActivity","UserFollowersOrFollowingFeed","feedArr","timeAgoRef","fetchMoreDiv","cursorId","fetchMoreDivId","gqlQuery","query","get","endOfPosts","client","history","location","pathname","scroll","document","removeEventListener","current","refetch","variables","loading","error","data","handleHeader","map","followOrActivity","i","_id","user","hasOwnProperty","follows"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport { useQuery, useApolloClient } from '@apollo/client';\nimport { useHistory } from 'react-router-dom';\nimport Cookies from 'js-cookie';\n\nimport UserResult from '../search/resultTypes/User_Result';\nimport CheckOutTheseBlogs from '../dashboard/util/Check_Out_These_Blogs';\n\nimport Queries from '../../graphql/queries.js';\nimport FeedUtil from '../posts/util/functions/feed_util.js';\nimport ActivityUtil from '../nav/util/activity_util.js';\nconst { handleActivity, handleTimeAgo } = ActivityUtil;\nconst { FETCH_USER_FOLLOWERS, \n        FETCH_FOLLOWED_USERS, \n        FETCH_ALL_ACTIVITY } = Queries;\nconst { infiniteScroll, \n        updateCacheInfScrollUserFollowers, \n        updateCacheInfScrollFollowedUsers,\n        handleData, \n        setgqlQueryUserFollowedOrFollowingOrActivity } = FeedUtil;\n\nconst UserFollowersOrFollowingFeed = () => {\n  let feedArr = useRef([]);\n  let timeAgoRef = useRef([]);\n  let fetchMoreDiv = useRef(null);\n  let cursorId = useRef(null);\n  let fetchMoreDivId = useRef('#fetchMoreFollowers');\n  let gqlQuery = useRef(FETCH_USER_FOLLOWERS)\n  let query = useRef(Cookies.get('currentUser'));\n  let endOfPosts = useRef(false);\n  const client = useApolloClient();\n  let history = useHistory();\n\n  setgqlQueryUserFollowedOrFollowingOrActivity(\n    history.location.pathname,\n    gqlQuery,\n    FETCH_USER_FOLLOWERS,\n    FETCH_FOLLOWED_USERS,\n    FETCH_ALL_ACTIVITY\n  )\n  \n  useEffect(() => {\n    var scroll;\n  \n    if (history.location.pathname === '/followers') {\n      scroll = infiniteScroll(\n        client, updateCacheInfScrollUserFollowers,\n        query, gqlQuery,\n        cursorId, fetchMoreDiv,\n        fetchMoreDivId\n      )\n    } else {\n      scroll = infiniteScroll(\n        client, updateCacheInfScrollFollowedUsers,\n        query, gqlQuery,\n        cursorId, fetchMoreDiv,\n        fetchMoreDivId\n      )\n    }\n\n    return () => {\n      document.removeEventListener('scroll', scroll)\n      timeAgoRef.current = []\n      refetch()\n    }\n\n    //eslint-disable-next-line\n  }, [])\n  \n  let { loading, error, data, refetch } = useQuery(gqlQuery.current, {\n    variables: {\n      query: Cookies.get('currentUser'),\n      cursorId: null\n    }\n  })\n\n  if (loading) return 'Loading...';\n  if (error) return `Error: ${error}`;\n  \n  handleData(data, feedArr, cursorId, endOfPosts)\n\n  const handleHeader = () => {\n    if (history.location.pathname === '/followers') {\n      return (\n        <h1>Followers</h1>\n      )\n    } else if (history.location.pathname === '/following'){\n      return (\n        <h1>Following</h1>\n      )\n    } else {\n      return (\n        <h1>Activity</h1>\n      )\n    }\n  }\n  \n  return(\n    <div\n      className='followContainer'\n    >\n        <div\n          className='outerContainer'\n        >\n\n          {handleHeader()}\n\n          <div\n            className={\n              history.location.pathname === '/activity' ?\n              'activity' :\n              'followFeedContainer'\n            }\n          >\n            {feedArr.current.map((followOrActivity, i) => {\n              if (history.location.pathname === '/activity') {\n                return (\n                  <div\n                    key={followOrActivity._id}\n                  >\n                    {handleTimeAgo(followOrActivity, timeAgoRef)}\n                    {handleActivity(followOrActivity)}\n                  </div>\n                )\n              } else {\n                var user = followOrActivity.hasOwnProperty('follows') ? \n                followOrActivity.follows : \n                followOrActivity.user\n                return (\n                  <div\n                    key={user._id}\n                    className='followResult'\n                  >\n                    <UserResult\n                      user={user}\n                    />\n                  </div>\n                )\n              }\n            })}\n          </div>\n          <div\n            id='fetchMoreFollowers'\n          >\n          </div>\n        </div>\n\n        <CheckOutTheseBlogs />\n    </div>\n  )\n}\n\nexport default UserFollowersOrFollowingFeed;"]},"metadata":{},"sourceType":"module"}